---
- name: Lookup generated configuration files
  find:
    paths:
      - "{{ k8s_combine_cfg }}"
    file_type: file
    patterns: "*.yaml"
  register: kube_config

- name: Apply Kubernetes configuration
  command: kubectl apply -f {{ item.path }}
  args:
    chdir: "{{ k8s_working_dir }}"
  with_items: "{{ kube_config.files | sort(attribute='path') }}"
