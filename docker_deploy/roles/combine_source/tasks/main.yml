---
##############################################################
# Role: the_combine_source
#
# Install the source code for TheCombine so that the Docker
# containers can be built on the target systems for later
# deployment
##############################################################

# check to see if source code is installed
- name: get source code from GitHub
  git:
    repo: "https://github.com/sillsdev/TheCombine.git"
    dest: "{{ source_dir }}"
    clone: yes
    update: yes
    version: "{{ combine_source_version }}"
    track_submodules: yes
    force: yes

- name: create directory for nginx runtime scripts
  file:
    path: "{{ source_dir }}/docker_deploy/nginx/scripts"
    state: directory

- name: create runtime config file
  template:
    src: config.js.j2
    dest: "{{ source_dir }}/docker_deploy/nginx/scripts/config.js"
