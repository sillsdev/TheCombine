---
##############################################################
# Role: the_combine_source
#
# Install the source code for TheCombine so that the Docker
# containers can be built on the target systems for later
# deployment
##############################################################

# check to see if source code is installed
- name: check for existing source code
  stat:
    path: /opt/TheCombine
  register: combinestat

- name: get source code from GitHub
  git:
    repo: "https://github.com/sillsdev/TheCombine.git"
    dest: "/opt/TheCombine"
    clone: yes
    update: yes
    version: docker_deploy
    depth: 1
    track_submodules: yes
  when: not combinestat.stat.exists

- name: update source code from GitHub
  command: git pull
  args:
    chdir: /opt/TheCombine
  when: combinestat.stat.exists
