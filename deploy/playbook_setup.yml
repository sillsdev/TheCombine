---

- name: Setup Ubuntu Server
  hosts: all
  become: yes

  roles:
    - role: ansible-depends
    - role: headless
    - role: nodejs
    - role: setup_mongodb
    - role: setup_dotnet_core
    - role: setup_apache
    - role: wifi_ap
    - role: setup_application

  tasks:
    - name: See if ubuntu-desktop is installed
      command: dpkg -l ubuntu-desktop
      changed_when: false
      ignore_errors: yes
      register: desktop_status

    - name: Install the One True Editor
      apt:
        name: emacs-nox
        state: present
      when: desktop_status is failed
