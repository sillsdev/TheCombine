---
#################################################
# Group specific configuration items
#
# Group: nuc
################################################

config_analytics_write_key: ""

#################################################
# TheCombine is installed using Ansible and the playbook_install.yml
# playbook.  It will set the IMAGE_TAG environment variable to
# value provided by the user and launch docker-compose
################################################
image_tag: "{{ combine_version | default('${IMAGE_TAG}') }}"

combine_image_backend: "{{ aws_ecr }}/combine_backend:{{ image_tag }}"
combine_image_frontend: "{{ aws_ecr }}/combine_frontend:{{ image_tag }}"
combine_image_certmgr: "{{ aws_ecr }}/combine_certmgr:{{ image_tag }}"

################################################
# SSL cert variables specific to NUC targets
################################################
cert_mode: "cert-client"
cert_email: "cert@thecombine.app"
cert_self_renewal: 60
combine_alias_domain_list: []
combine_cert_proxy_list: []

################################################
# setup variables for roles/aws_access
################################################
aws_user: "{{ combine_user }}"
aws_group: "{{ combine_group }}"

################################################
# AWS S3 storage configuration
################################################
aws_s3_loc: thecombine.app
aws_s3_backup_loc: "{{ aws_s3_loc }}/backups"
aws_s3_cert_loc: "{{ aws_s3_loc }}/certs"

aws_s3_profile: s3_read_write
aws_ecr_profile: ecr_read_only

my_aws_profiles:
  - "{{ aws_s3_profile }}"
  - "{{ aws_ecr_profile }}"

################################################
# Configure Kubernetes cluster
################################################
k8s_components:
  - microk8s
  - cert_manager
  - ingress_controller

image_pull_secret: aws-ecr-cred

aws_ecr_login:
  # Specify how you want the job to run, either "on_demand" or "cron"
  # schedule is ignored if job_type is 'on_demand'
  cron: no
  job_name: ecr-cred-helper
  cron_job_name: ecr-cred-helper-cron
  schedule: "* */8 * * *"

app_namespace: thecombine

k8s_user: sillsdev
k8s_group: sillsdev

#######################################
# Ingress configuration (microk8s ingress addon)
ingress_class: public

# For the NUCs we want to use the ansible host name
# since that is how we can connect on the local network
# The server name will direct traffic to the production
# server since it is used to get the certificates for the
# NUC.
k8s_dns_name: "{{ ansible_hostname }}"

################################################
# The use model for the Combine when deployed on
# a NUC is for workshops in areas with unreliable
# or no internet connection.  As a result, the
# CAPTCHA and functions that require email are
# are disabled.
################################################
config_captcha_required: "false"
config_captcha_sitekey: "none"
config_email_enabled: "false"

################################################
# Ethernet settings
################################################
eth_optional: yes

################################################
# WiFi access point settings
################################################
has_wifi: yes
ap_domain: thecombine.app
ap_ssid: "{{ansible_hostname}}_ap"
# ap_passphrase is defined in ./vault.yml
ap_gateway: "10.10.10.1"
ap_hostname: "{{ansible_hostname}}"
