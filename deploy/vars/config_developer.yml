---

# config_developer

# path for The Combine application
application_path: "/var/www/html/TheWordCombine"
# mongo_path: /hddlinux/mongodb
mongo_path: /var/lib/mongodb

### Version/distro
base_distribution: "{{ansible_distribution | lower}}"
base_distribution_release: "{{ansible_distribution_release}}"

#node_version: 10.16.0
#mongodb_version: 4.0

### SSL config
ssl_letsencrypt_install: false

ssl_items:
  - name: thewordcombine
    state: selfsign
    request:
        country_code: "US"
        state: "TX"
        locality: "Dallas"
        organization: "SIL"
        organization_unit: ""
        common_name: "thewordcombine.local"
        alt_names:
          - key: DNS.1
            value: "www.thewordcombine.local"
          - key: DNS.2
            value: "thewordcombine.local"
    sign:


### Apache config
apache_module_enable:
  - headers
  - proxy
  - proxy_http
  - proxy_wstunnel
  - rewrite
  - ssl

apache_site_enable:
  - default_local.conf
  - thewordcombine_org.conf

apache_vhosts:
  - server_name: default.local
    server_admin: jimgrady.jg@gmail.com
    server_file_name: default_local
    template: vhost_proxypath_ssl.conf.j2
    document_root: "{{ application_path }}"
    directory_options:
      - "+Indexes"
      - "+FollowSymLinks"
    directory_extra:
      - RewriteEngine On
    virtual_hosts:
      - has_ssl: false
        listen: 10.10.0.1
        port: 80
        server_alias:
          - localhost
        proxy:
          - '/api2/ http://localhost:5000/'
          - '/machine/ http://localhost:5001/'
          - '/sharedb/ "ws://localhost:5002/"'
  - server_name: thewordcombine.org
    server_admin: jimgrady.jg@gmail.com
    server_file_name: thewordcombine_org
    template: vhost_proxypath_ssl.conf.j2
    document_root: "{{ application_path }}"
    directory_extra:
      - RewriteEngine On
    virtual_hosts:
      - has_ssl: false
        listen: 10.10.0.1
        port: 80
        server_alias:
          - thewordcombine.local
          - thewordcombine.localhost
          - localhost
        extra:
        - '<ifModule mod_headers.c>'
        - '    <Files "service-worker.js">'
        - '        Header Set Service-Worker-allowed "/"'
        - '    </Files>'
        - '</IfModule>'
        proxy:
          - '/api2/ http://localhost:5000/'
          - '/machine/ http://localhost:5001/'
          - '/sharedb/ "ws://localhost:5002/"'
      - has_ssl: true
        port: 443
        certificate_file: "thewordcombine.pem"
        key_file: "thewordcombine.key"
        extra:
        - '<ifModule mod_headers.c>'
        - '    <Files "service-worker.js">'
        - '        Header Set Service-Worker-allowed "/"'
        - '    </Files>'
        - '</IfModule>'
        proxy:
          - '/api2/ http://localhost:5000/'
          - '/machine/ http://localhost:5001/'
          - '/sharedb/ "ws://localhost:5002/"'
