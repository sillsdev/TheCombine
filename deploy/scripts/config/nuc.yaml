---
#################################################
# Group specific configuration items
#
# Group: nuc
################################################

config_analytics_write_key: ""

#################################################
# Docker image configurations
################################################
image_tag: "{{ combine_version }}"

combine_image_backend: "{{ aws_ecr }}/combine_backend:{{ image_tag }}"
combine_image_frontend: "{{ aws_ecr }}/combine_frontend:{{ image_tag }}"
combine_image_maintenance: "{{ aws_ecr }}/combine_maint:{{ image_tag }}"

################################################
# Configure Kubernetes cluster
################################################

# Specify which Kubernetes engine to install -
# one of k3s or none.
k8s_engine: k3s
k8s_components:
  - ingress_controller
  - cert_proxy_client

image_pull_secret: aws-login-credentials

# k8s namespaces
app_namespace: thecombine
cert_proxy_namespace: "{{ app_namespace }}"

create_namespaces:
  - "{{ app_namespace }}"

aws_ecr_login:
  cron: no
  image: sillsdev/aws-kubectl:0.1.9
  secrets_name: aws-ecr-credentials
  config_name: aws-ecr-config
  pull_secret_name: "{{ image_pull_secret | default('aws-login-credentials') }}"
  job_name: ecr-cred-helper

k8s_user: sillsdev
k8s_group: sillsdev

#######################################
# k8s Upgrade strategy
#   Recreate - for the NUCs where they are updated offline
#   RollingUpdate - for the servers and qa which are available
#              during an update
k8s_update_strategy: Recreate

#######################################
# Ingress configuration
ingress_class: nginx
ingress_namespace: ingress-nginx

# For the NUCs we want to use the ansible host name
# since that is how we can connect on the local network
# The server name will direct traffic to the production
# server since it is used to get the certificates for the
# NUC.
k8s_dns_name: "{{ ansible_hostname }}"

################################################
# The use model for the Combine when deployed on
# a NUC is for workshops in areas with unreliable
# or no internet connection.  As a result, the
# CAPTCHA and functions that require email are
# are disabled.
################################################
config_captcha_required: "false"
config_captcha_sitekey: "none"
config_email_enabled: "false"

ap_domain: thecombine.app
ap_ssid: "{{ansible_hostname}}_ap"
# ap_passphrase is defined in ./vault.yml
ap_gateway: "10.10.10.1"
ap_hostname: "{{ansible_hostname}}"
